---
import { projectsSection } from "../../data/projects";
import { projectsInMemoryRepository } from "../../infrastructure/projectsInMemoryRepository";

const { currentLang } = Astro.props;

const lang = (currentLang === "en" ? "en" : "es") as "en" | "es";
const projects = await projectsInMemoryRepository.getProjects(lang);
---

<section id="projects" class="py-20 relative section-bg-3">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Modern Section Header -->
    <div class="text-center mb-16">
      <div
        class="inline-block px-6 py-3 theme-glass rounded-lg theme-border mb-6 animate-fade-in-up animate-delay-200"
      >
        <h2 class="text-3xl md:text-4xl font-bold theme-text">
          {projectsSection.title[lang]}
        </h2>
      </div>
      <div
        class="w-24 h-0.5 mx-auto mb-6 animate-fade-in-up animate-delay-400"
        style="background: linear-gradient(to right, transparent, var(--accent-primary), transparent);"
      >
      </div>
      <p
        class="text-xl theme-text-secondary font-light animate-fade-in-up animate-delay-600"
      >
        {projectsSection.subtitle[lang]}
      </p>
    </div>

    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
      {
        projects.map((project, index) => (
          <div
            class={`group theme-glass rounded-xl theme-border hover:bg-white/8 transition-all duration-500 hover:scale-105 hover:shadow-2xl hover:shadow-slate-500/25 animate-fade-in-up animate-delay-${800 + index * 200} overflow-hidden`}
          >
            <div class="h-48 theme-gradient relative overflow-hidden">
              <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent" />
              <div class="absolute bottom-4 left-4 theme-text">
                <h3 class="text-2xl font-bold mb-2">{project.title[lang]}</h3>
                <p class="theme-text/90 text-sm">{project.subtitle[lang]}</p>
              </div>
              <div class="absolute top-4 right-4 w-3 h-3 bg-green-500 rounded-full" />
            </div>
            <div class="p-6">
              <p class="theme-text/80 mb-6 leading-relaxed text-sm">
                {project.description[lang]}
              </p>
              <div class="flex flex-wrap gap-2 mb-6">
                {project.technologies.map((tech) => (
                  <span class="px-3 py-1 bg-white/10 backdrop-blur-sm theme-text/90 text-xs font-medium rounded-lg border border-white/20">
                    {tech}
                  </span>
                ))}
              </div>
              <div class="flex space-x-4">
                <a
                  href={project.demoUrl}
                  class="text-slate-300 hover:theme-text font-medium text-sm transition-colors flex items-center"
                >
                  <svg
                    class="w-4 h-4 mr-1"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                    />
                  </svg>
                  {projectsSection.viewDemoLabel[lang]}
                </a>
                <a
                  href={project.codeUrl}
                  class="theme-text/60 hover:theme-text font-medium text-sm transition-colors flex items-center"
                >
                  <svg
                    class="w-4 h-4 mr-1"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"
                    />
                  </svg>
                  {projectsSection.codeLabel[lang]}
                </a>
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>
